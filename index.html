<!DOCTYPE html>
<html>
  <head>
    <title>Hello World!</title>
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css"></link>
    <link rel="stylesheet" href="css/filebrowser.css"></link>
    <link rel="stylesheet" href="css/contextmenu.css"></link>
    <link rel="stylesheet" href="css/main.css"></link>
    <script src="https://kit.fontawesome.com/16fed93f1f.js" crossorigin="anonymous"></script>
  </head>
  <body>
    
    <section id="topbar">
      topbar
    </section>
    
    <section id="filebrowser">
      
      <div class="fb-section">
        <button class="fb-title-btn">
          <div class="fb-title-btn-title">LOCAL NOTES</div>
        </button>
        <div id="local-notes"></div>
      </div>
    </section>

    <section id="notepad">
        <div id="editorcontainer">
          <div id="editor">text text testx text</div>
        </div>
    </section>

    <section id="timeline">
      <div id="timeline-top-buttons">
        <div id="timeline-new-event-btn">New Event</div>
        <div class="flex">
          <div class="timeline-hour-input" contenteditable="true" id="timeline-starthour-input">999</div>
          <div class="timeline-hour-input" contenteditable="true" id="timeline-endhour-input">999</div>
        </div>
      </div>
      <div id="timeline-body"></div>
      <div id="timeline-c-div">
        <form>
          <div id='timeline-c-container'> 
            <div class='tc-title-input tc-input-container'>
              <label>Title</label>
              <div id="tc-title" contenteditable="true" class="tc-input-title tc-input"></div>
            </div>
            <div class='tc-input-container'>
              <label>Start</label>
              <div id="tc-starthour" contenteditable="true" class="tc-input"></div>
              <div id="tc-startmin" contenteditable="true" class="tc-input"></div>
            </div>
            <div class='tc-input-container'>
              <label>End</label>
              <div id="tc-endhour" contenteditable="true" class="tc-input"></div>
              <div id="tc-endmin" contenteditable="true" class="tc-input"></div>
            </div>
            <div class="tc-date-input tc-input-container">
              <label>Date</label>
              <div id="tc-month" contenteditable="true" class="tc-input"></div>
              <div id="tc-day" contenteditable="true" class="tc-input"></div>
              <div id="tc-year" contenteditable="true" class="tc-input"></div>
            </div>
            <div class="fill-div">
              <div id='tc-remove' class="tc-button cursornone"></div>
              <div id='tc-submit' class="tc-button cursornone"></div>
              <div id='tc-cancel' class="tc-button cursornone"></div>
            </div>
          </div>
        </form>
      </div>
    </section>

    <div id="timeline-new-event-modal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <form>
          <div id='timeline-n-container'> 

            <div class='tn-input-title tn-input-container'>
              <label>Title</label>
              <input type="text" id="tmei-title">
            </div>

            <div class='tn-input-container'>
              <label>Start</label>
              <div id="tc-starthour" contenteditable="true" class="tc-input"></div>
              <div id="tc-startmin" contenteditable="true" class="tc-input"></div>
            </div>
            
          </div>
          <button type="submit" id='tme-submit-btn'>Create</button>
        </form>
      </div>
    </div>
    
  </body>

  <!-- TEMPLATES -->

  <template id="template-fb-item">
    <div class="fb-item">
        <button class="fb-item-btn">
          <i class=""></i>
          <div class="fb-item-title">
            TITLE
          </div>
        </button>
        <section class="fb-item-children"></section>
    </div>
  </template>

  <template id="template-fb-item-dragging">
    <div class="fb-item-dragging fb-item-btn"></div>
  </template>

  <template id="template-context-menu">
    <div class="custom-context-menu"></div>
  </template>

  <!-- SCRIPTS -->

  <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script type="module">
    import {FileBrowser} from "./renderer-process/FileBrowser.js"
    import {Notepad} from "./renderer-process/Notepad.js"
    import {Timeline} from "./renderer-process/Timeline.js"
    
    window.addEventListener("beforeunload", function(ev) {
      console.log('TODO: what to do before unload')
    })

    let keydowns = new Object();
    $(document).keydown(function(event) {
      keydowns[event.which] = true
      if (keydowns[17] && keydowns[83]) {
        Notepad.Save()
      }
    })
    $(document).keyup(function(event) {
      keydowns[event.which] = false
    })

    $(function() {

      FileBrowser.Refresh()
      Notepad.Refresh()
      Timeline.Refresh()
      
      var quill = new Quill("#editor",{
        modules: {
          toolbar: [
            ['bold', 'italic', 'underline', {
              'color': []
              }, {
                  "background": []
                }, {
                    "font": []
                }, {
                    "size": []
                }, {
                    align: []
                }, 'image', 'code-block']]
            },
            scrollingContainer: "#editorcontainer",
            theme: "snow"
        });

      let $notepad = $('#notepad')
      let $editorcontainer = $('#editorcontainer')
      $editorcontainer.height($notepad.height()-70)
      window.addEventListener('resize', function(event) {
        $editorcontainer.height($notepad.height()-70)
      }, true);

    })
    
  </script>

</html>